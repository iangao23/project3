<html>
<head>
    <link rel="stylesheet" href="p3.css">
    <script src="https://www.cs.unm.edu/~angel/WebGL/7E/Common/initShaders.js" defer></script>
    <script src="https://www.cs.unm.edu/~angel/WebGL/7E/Common/MV.js" defer></script>
    <script src="models.js" defer></script>
    <script src="p3.js" defer></script>
</head>
<body>
    <div id="container">
        <div class="app">
            <div class="title">Satellite orbiting Mars</div>
            <div class="setting">
                <div class="control">
                    <ul>
                        <li>Camera settings</li>
                        <li><span class="red-font">X</span><span id="x_crd">=&nbsp;0.0</span></li>
                        <li><input type="range" id="xt" min="-5" max="5" step="0.01" value="0.0"></li>
                        <li><span class="green-font">Y</span><span id="y_crd">=&nbsp;0.0</span></li>
                        <li><input type="range" id="yt" min="-5" max="5" step="0.01" value="0.0"></li>
                        <li><span class="blue-font">Z</span><span id="z_crd">=&nbsp;1.8</span></li>
                        <li><input type="range" id="zt" min="-5" max="5" step="0.01" value="1.8"></li>
                        <li><span>FoV</span><span id="fovy">=&nbsp;45</span></li>
                        <li><input type="range" id="fov" min="10" max="100" step="1" value="45"></li>
                        <li>Light position</li>
                        <li><span class="red-font">X</span><span id="lx_crd">=&nbsp;1.0</span></li>
                        <li><input type="range" id="lxt" min="-1" max="1" step="0.01" value="1.0"></li>
                        <li><span class="green-font">Y</span><span id="ly_crd">=&nbsp;1.0</span></li>
                        <li><input type="range" id="lyt" min="-1" max="1" step="0.01" value="1.0"></li>
                        <li><span class="blue-font">Z</span><span id="lz_crd">=&nbsp;1.0</span></li>
                        <li><input type="range" id="lzt" min="-1" max="1" step="0.01" value="1.0"></li>
                        <li><button id="reset_cl">reset</button></li>
                    </ul>
                </div> <!-- end control -->
                <div class="rock">
                    <canvas id="webgl-canvas">
                        Oops, your browser doesn't support the HTML5 canvas!
                    </canvas>
                </div> <!-- end rock -->
                <div class="control">
                  <ul>
                        <li>Satellite settings</li>
                        <li><span>Orbit speed</span><span id="os_crd">=&nbsp;3</span></li>
                        <li><input type="range" id="os" min="0" max="10" step="0.1" value="3"></li>
                        <li><span>Orbit distance</span><span id="od_crd">=&nbsp;0.65</span></li>
                        <li><input type="range" id="od" min="0.5" max="1.5" step="0.05" value="0.65"></li>
                        <li><span>Orbit angle</span><span id="oa_crd">=&nbsp;45</span></li>
                        <li><input type="range" id="oa" min="0" max="180" step="1" value="45"></li>
                        <li><button id="reset_ss">reset</button></li>          
                    </ul> 
                </div> <!-- end control -->
            </div> <!-- end setting -->
        </div> <!-- end app -->
    </div> <!-- end containter -->
</body>  
<script id="vertex-shader" type="x-shader/x-vertex">

  // ----------------------------------------------
  // Complete the GLSL program
  // ----------------------------------------------
  attribute vec4 vPosition;
  attribute vec3 vNormal;
  
  uniform mat4 modelViewMatrix;
  uniform mat4 projectionMatrix;
  uniform mat3 normalMatrix;
  uniform vec4 lightPosition;
  
  varying vec3 fN;
  varying vec3 fL;
  varying vec3 fE;
  
  void main() {
    // Transform vertex position
    vec3 pos = (modelViewMatrix * vPosition).xyz;
    
    // Transform normal
    fN = normalize(normalMatrix * vNormal);
    
    // Light direction
    fL = normalize(lightPosition.xyz - pos);
    
    // Eye direction (viewer is at origin in eye coordinates)
    fE = normalize(-pos);
    
    // Output position
    gl_Position = projectionMatrix * modelViewMatrix * vPosition;

  }

</script>

<script id="fragment-shader" type="x-shader/x-fragment">
 
  precision mediump float;
  
  // ----------------------------------------------
  // Variables that are provided to you.
  // ----------------------------------------------
  float shininess = 20.0;
  vec4 kd = vec4( 1.0, 1.0, 1.0, 1.0 ); // diffuse material property
  vec4 ka = vec4( 0.5, 0.5, 0.5, 1.0 ); // ambient material property
  // ----------------------------------------------

  // ----------------------------------------------
  // Complete the GLSL program
  // ----------------------------------------------
  uniform vec4 objectColor;
  
  varying vec3 fN;
  varying vec3 fL;
  varying vec3 fE;
  
  void main() {
    vec3 N = normalize(fN);
    vec3 L = normalize(fL);
    vec3 E = normalize(fE);
    vec3 H = normalize(L + E);
    
    vec4 lightAmbient = vec4(1.0, 1.0, 1.0, 1.0);
    vec4 lightDiffuse = vec4(1.0, 1.0, 1.0, 1.0);
    vec4 lightSpecular = vec4(1.0, 1.0, 1.0, 1.0);
    
    vec4 ks = vec4(1.0, 1.0, 1.0, 1.0);
    
    vec4 ambient = ka * lightAmbient * objectColor;
    
    float diffuseFactor = max(dot(L, N), 0.0);
    vec4 diffuse = kd * lightDiffuse * objectColor * diffuseFactor;
    
    float specularFactor = pow(max(dot(N, H), 0.0), shininess);
    vec4 specular = ks * lightSpecular * specularFactor;
    
    if (dot(L, N) < 0.0) {
        specular = vec4(0.0, 0.0, 0.0, 1.0);
    }
    
    gl_FragColor = ambient + diffuse + specular;
    gl_FragColor.a = 1.0;
   
 
  }

 </script>

</html>